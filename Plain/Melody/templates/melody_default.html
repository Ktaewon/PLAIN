{% extends "base.html" %}
{% load static %}
{% block title %}submain 페이지{% endblock %}

{% block style %}
<link rel="stylesheet" href="{% static 'css/melody_default.css' %}" type="text/css">
{% endblock %}

{% block out_container_content %}
<script src="//cdnjs.cloudflare.com/ajax/libs/wavesurfer.js/1.4.0/wavesurfer.min.js"></script>
<div class="container-all-1">
    <div class="container1">
        <div class="container1-1">
            <div class="container1-1-1">
                <div class="1">
                    <button onclick="wavesurfer.playPause()"><img class="button" src="https://icongr.am/entypo/controller-play.svg?size=111&color=currentColor" alt=""></button>
                </div>
                <div class="class-2">
                    <div class="owner"> {{melody.owner}}  <!--글쓰기--></div>
                    <div class="title">{{ melody.title}} <!--제목--></div>
                </div>
            </div>
            <div class="container1-1-2">
                <div class="class-3">
                     <!--hashtags-->
                    {% for tag in melody.hashtags.all %}
                    <span class="badge badge-dark">
                    #{{ tag.name }}
                    </span>
                    {% endfor %}
                </div>
            </div>
        </div>
        <br>
        <br>
        <div class="container1-2">
            <div class="4">
                <!--파형그리기-->
                <div id="waveform"></div>
                <script>
                    var wavesurfer = WaveSurfer.create({
                        // id="waveform" 인 오브젝트에 파형 생성
                        // 필수 옵션
                        container: '#waveform',
                        // 선택 옵션들 
                        waveColor: '#02D5C6',
                        progressColor: '#008179',
                        barWidth: 3,
                    });
                    //var wav = new Audio("{% static 'audio/music.mp3' %}");
                    //wavesurfer.load("{% static 'audio/music.mp3' %}");
                    wavesurfer.load("{{melody.audio.url}}");
        
                </script>
            </div>
        </div>
    </div>
    <div class="container2">
      <div class="class-5">
            <!--image받은 것!-->
            <img class="thumbnail" src="{{melody.img.url}}" alt="My Image" width="100" height="200">
      </div>
    </div>
</div>

<div class="container-all-2">

    <div class="6">네브 버튼들</div>
    <div class="7">

        <!--댓글한개-->
        {% for comment in comments %}
        <div class="card">
            <div class="card-body">
                <h5>{{comment.body}}</h5> <!--코멘트-->
                <h6>{{comment.position}}</h6> <!--positon-->
                <h6>작성자 : {{comment.writer}} 날짜 : {{comment.pub_date}}</h6> <!--작성자랑 정보-->
                 <!--오디오파일 "{% static 'audio/music.mp3' %}" -->
                <audio src="{{comment.audio.url}}" autoplay loop controls id="myAudio">오디오 지원되지 않는 브라우저</audio>  <!--오디오파일-->
                
                <!--파형 버전
                <div id="comment_waveform">
                    <script>
                        var wavesurfer = WaveSurfer.create({
                            // id="waveform" 인 오브젝트에 파형 생성
                            // 필수 옵션
                            container: '#comment_waveform',
                            // 선택 옵션들 
                            waveColor: '#02D5C6',
                            progressColor: '#008179',
                            barWidth: 3,
                        });
                        //var wav = new Audio("{% static 'audio/music.mp3' %}");
                        wavesurfer.load("{% static 'audio/music.mp3' %}");
                    </script>
                    <button onclick="wavesurfer.playPause()"><img class="button2"  alt="">play/pause</button>
                </div>
                -->
                
            </div>
        </div>
        {% endfor %}
        <br><br>

        <!--댓글작성 폼-->
        <form method="POST" action="{% url 'comment' melody.id %}" enctype="multipart/form-data">
            {% csrf_token %}
            <textarea cols=125 rows=2 name="body">leave a message</textarea>  <!--comment 남기는 것-->
            <textarea cols=125 rows=2 name="position">leave a postion</textarea>  <!--position 받기  (나중에는 textarea 말고 melody에서 받은 position값으로 checkbox 만들고 선택하도록하면 될듯)-->
            <!--음악 파일 삽입하는 부분-->
            <div>
                <input type="file" id="commendInput" name="commendInput" class="" accept="audio/*" required>
            </div>
            
            <input class="btn btn-dark" type="submit" value="댓글 달기!">
        </form>

    </div>
</div>

{% endblock %}

{% block in_container_content %}

{% endblock %}

